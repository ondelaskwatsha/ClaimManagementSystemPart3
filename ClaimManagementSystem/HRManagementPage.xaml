<Page x:Class="ClaimManagementSystem.HRManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="HR Management">
    <ScrollViewer>
        <StackPanel Margin="20">
            <TextBlock Text="HR Management" FontSize="28" FontWeight="Bold" Margin="0,0,0,20"/>

            <!-- Report Generation -->
            <GroupBox Header="Payment Report Generation" Margin="0,0,0,20">
                <StackPanel Margin="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="From Date" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <DatePicker x:Name="dpFromDate" Padding="10"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Margin="0,0,10,0">
                            <TextBlock Text="To Date" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <DatePicker x:Name="dpToDate" Padding="10"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2" VerticalAlignment="Bottom">
                            <Button Content="Generate Payment Report" 
                                    Click="BtnGenerateReport_Click" 
                                    Padding="15,8" Background="#3498db" Foreground="White"/>
                        </StackPanel>
                    </Grid>

                    <!-- NEW: Download Report Button -->
                    <Button x:Name="btnDownloadReport" Content="Download Report as CSV" 
                            Click="BtnDownloadReport_Click" Margin="0,10,0,0"
                            Background="#e67e22" Foreground="White" Padding="15,8"
                            IsEnabled="False"/>

                    <Button Content="Export All Approved Claims to CSV" 
                            Click="BtnExportClaims_Click" Margin="0,10,0,0"
                            Background="#27ae60" Foreground="White" Padding="15,8"/>
                </StackPanel>
            </GroupBox>

            <!-- Rest of your existing XAML remains the same -->
            <GroupBox Header="Lecturer Management" Margin="0,0,0,20">
                <StackPanel Margin="10">
                    <DataGrid x:Name="dgLecturers" AutoGenerateColumns="False" 
                             Height="120" Margin="0,0,0,10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding FullName}" Width="*"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                            <DataGridTextColumn Header="Department" Binding="{Binding Department}" Width="150"/>
                            <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="120"/>
                            <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Orientation="Horizontal">
                        <Button Content="Add New Lecturer" Click="BtnAddLecturer_Click" 
                                Margin="0,0,10,0" Padding="10,5"/>
                        <Button Content="Deactivate User" Click="BtnDeactivateUser_Click" 
                                Background="#e74c3c" Foreground="White" Padding="10,5"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <!-- Payment Processing -->
            <GroupBox Header="Payment Processing">
                <StackPanel Margin="10">
                    <DataGrid x:Name="dgApprovedClaims" AutoGenerateColumns="False" 
                             Height="98" Margin="0,0,0,10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Lecturer" Binding="{Binding UserEmail}" Width="200"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="*"/>
                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=R{0:N2}}" Width="100"/>
                            <DataGridTextColumn Header="Approved Date" Binding="{Binding ApprovedDate, StringFormat=MM/dd/yyyy}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Button Content="Process Selected Payments" 
                            Click="BtnProcessPayments_Click" 
                            Background="#9b59b6" Foreground="White" Padding="10,5"/>
                </StackPanel>
            </GroupBox>

            <!-- Statistics -->
            <Border Background="#f8f9fa" Padding="15" CornerRadius="5" Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="System Statistics" FontWeight="Bold" Margin="0,0,0,10"/>
                    <WrapPanel>
                        <TextBlock x:Name="txtTotalUsers" Margin="0,0,20,0"/>
                        <TextBlock x:Name="txtTotalClaims" Margin="0,0,20,0"/>
                        <TextBlock x:Name="txtPendingPayments" Margin="0,0,20,0"/>
                        <TextBlock x:Name="txtTotalAmount" Margin="0,0,20,0"/>
                    </WrapPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>